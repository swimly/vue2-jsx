!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).scroller=e()}(this,(function(){"use strict";var t="mc-scroller",e="mc-scroller-content",n="mc-scroller-bar",i=function(){var t,e,n=document.createElement("DIV");return n.style.cssText="position:absolute; top:-1000px; width:100px; height:100px; overflow:hidden;",t=document.body.appendChild(n).clientWidth,n.style.overflowY="scroll",e=n.clientWidth,document.body.removeChild(n),t-e};function o(t,e){return t(e={exports:{}},e.exports),e.exports}var r=o((function(t){(t.exports={}).forEach=function(t,e){for(var n=0;n<t.length;n++){var i=e(t[n]);if(i)return i}}})),l=o((function(t){var e=t.exports={};e.isIE=function(t){return(-1!==(e=navigator.userAgent.toLowerCase()).indexOf("msie")||-1!==e.indexOf("trident")||-1!==e.indexOf(" edge/"))&&(!t||t===function(){var t=3,e=document.createElement("div"),n=e.getElementsByTagName("i");do{e.innerHTML="\x3c!--[if gt IE "+ ++t+"]><i></i><![endif]--\x3e"}while(n[0]);return t>4?t:undefined}());var e},e.isLegacyOpera=function(){return!!window.opera}})),a=o((function(t){(t.exports={}).getOption=function(t,e,n){var i=t[e];if(null==i&&void 0!==n)return n;return i}})),s=function(t){var e=(t=t||{}).reporter,n=a.getOption(t,"async",!0),i=a.getOption(t,"auto",!0);i&&!n&&(e&&e.warn("Invalid options combination. auto=true and async=false is invalid. Setting async=true."),n=!0);var o,r=c(),l=!1;function s(){for(l=!0;r.size();){var t=r;r=c(),t.process()}l=!1}function d(){var t;t=s,o=setTimeout(t,0)}return{add:function(t,e){!l&&i&&n&&0===r.size()&&d(),r.add(t,e)},force:function(t){l||(void 0===t&&(t=n),o&&(clearTimeout(o),o=null),t?d():s())}}};function c(){var t={},e=0,n=0,i=0;return{add:function(o,r){r||(r=o,o=0),o>n?n=o:o<i&&(i=o),t[o]||(t[o]=[]),t[o].push(r),e++},process:function(){for(var e=i;e<=n;e++)for(var o=t[e],r=0;r<o.length;r++){(0,o[r])()}},size:function(){return e}}}function d(t){return t._erd}var u={initState:function(t){return t._erd={},d(t)},getState:d,cleanState:function(t){delete t._erd}};u.initState,u.getState,u.cleanState;var f=r.forEach,h=function(t){var e=(t=t||{}).reporter,n=t.batchProcessor,i=t.stateHandler.getState;t.stateHandler.hasState;var o=t.idHandler;if(!n)throw new Error("Missing required dependency: batchProcessor");if(!e)throw new Error("Missing required dependency: reporter.");var r=function(){var t=500,e=500,n=document.createElement("div");n.style.cssText=s(["position: absolute","width: 1000px","height: 1000px","visibility: hidden","margin: 0","padding: 0"]);var i=document.createElement("div");i.style.cssText=s(["position: absolute","width: 500px","height: 500px","overflow: scroll","visibility: none","top: -1500px","left: -1500px","visibility: hidden","margin: 0","padding: 0"]),i.appendChild(n),document.body.insertBefore(i,document.body.firstChild);var o=t-i.clientWidth,r=e-i.clientHeight;return document.body.removeChild(i),{width:o,height:r}}(),l="erd_scroll_detection_container";function a(t){!function(t,e,n){function i(n,i){i=i||function(e){t.head.appendChild(e)};var o=t.createElement("style");return o.innerHTML=n,o.id=e,i(o),o}if(!t.getElementById(e)){var o=n+"_animation",r=n+"_animation_active",l="/* Created by the element-resize-detector library. */\n";l+="."+n+" > div::-webkit-scrollbar { "+s(["display: none"])+" }\n\n",l+="."+r+" { "+s(["-webkit-animation-duration: 0.1s","animation-duration: 0.1s","-webkit-animation-name: "+o,"animation-name: "+o])+" }\n",l+="@-webkit-keyframes "+o+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }\n",i(l+="@keyframes "+o+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }")}}(t,"erd_scroll_detection_scrollbar_style",l)}function s(e){var n=t.important?" !important; ":"; ";return(e.join(n)+n).trim()}function c(t,n,i){if(t.addEventListener)t.addEventListener(n,i);else{if(!t.attachEvent)return e.error("[scroll] Don't know how to add event listeners.");t.attachEvent("on"+n,i)}}function d(t,n,i){if(t.removeEventListener)t.removeEventListener(n,i);else{if(!t.detachEvent)return e.error("[scroll] Don't know how to remove event listeners.");t.detachEvent("on"+n,i)}}function u(t){return i(t).container.childNodes[0].childNodes[0].childNodes[0]}function h(t){return i(t).container.childNodes[0].childNodes[0].childNodes[1]}return a(window.document),{makeDetectable:function(t,a,d){function p(){if(t.debug){var n=Array.prototype.slice.call(arguments);if(n.unshift(o.get(a),"Scroll: "),e.log.apply)e.log.apply(null,n);else for(var i=0;i<n.length;i++)e.log(n[i])}}function m(t){var e=i(t).container.childNodes[0],n=window.getComputedStyle(e);return!n.width||-1===n.width.indexOf("px")}function g(){var t=window.getComputedStyle(a),e={};return e.position=t.position,e.width=a.offsetWidth,e.height=a.offsetHeight,e.top=t.top,e.right=t.right,e.bottom=t.bottom,e.left=t.left,e.widthCSS=t.width,e.heightCSS=t.height,e}function v(){if(p("storeStyle invoked."),i(a)){var t=g();i(a).style=t}else p("Aborting because element has been uninstalled")}function b(t,e,n){i(t).lastWidth=e,i(t).lastHeight=n}function y(){return 2*r.width+1}function w(){return 2*r.height+1}function x(t){return t+10+y()}function E(t){return t+10+w()}function S(t,e,n){var i=u(t),o=h(t),r=x(e),l=E(n),a=function(t){return 2*t+y()}(e),s=function(t){return 2*t+w()}(n);i.scrollLeft=r,i.scrollTop=l,o.scrollLeft=a,o.scrollTop=s}function T(){var t=i(a).container;if(!t){(t=document.createElement("div")).className=l,t.style.cssText=s(["visibility: hidden","display: inline","width: 0px","height: 0px","z-index: -1","overflow: hidden","margin: 0","padding: 0"]),i(a).container=t,function(t){t.className+=" "+l+"_animation_active"}(t),a.appendChild(t);var e=function(){i(a).onRendered&&i(a).onRendered()};c(t,"animationstart",e),i(a).onAnimationStart=e}return t}function k(){if(p("Injecting elements"),i(a)){!function(){var n=i(a).style;if("static"===n.position){a.style.setProperty("position","relative",t.important?"important":"");var o=function(t,e,n,i){var o=n[i];"auto"!==o&&"0"!==function(t){return t.replace(/[^-\d\.]/g,"")}(o)&&(t.warn("An element that is positioned static has style."+i+"="+o+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+i+" will be set to 0. Element: ",e),e.style[i]=0)};o(e,a,n,"top"),o(e,a,n,"right"),o(e,a,n,"bottom"),o(e,a,n,"left")}}();var n=i(a).container;n||(n=T());var o,d,u,f,h=r.width,m=r.height,g=s(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden","width: 100%","height: 100%","left: 0px","top: 0px"]),v=s(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden"].concat(["left: "+(o=(o=-(1+h))?o+"px":"0"),"top: "+(d=(d=-(1+m))?d+"px":"0"),"right: "+(f=(f=-h)?f+"px":"0"),"bottom: "+(u=(u=-m)?u+"px":"0")])),b=s(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),y=s(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),w=s(["position: absolute","left: 0","top: 0"]),x=s(["position: absolute","width: 200%","height: 200%"]),E=document.createElement("div"),S=document.createElement("div"),k=document.createElement("div"),A=document.createElement("div"),L=document.createElement("div"),z=document.createElement("div");E.dir="ltr",E.style.cssText=g,E.className=l,S.className=l,S.style.cssText=v,k.style.cssText=b,A.style.cssText=w,L.style.cssText=y,z.style.cssText=x,k.appendChild(A),L.appendChild(z),S.appendChild(k),S.appendChild(L),E.appendChild(S),n.appendChild(E),c(k,"scroll",D),c(L,"scroll",H),i(a).onExpandScroll=D,i(a).onShrinkScroll=H}else p("Aborting because element has been uninstalled");function D(){i(a).onExpand&&i(a).onExpand()}function H(){i(a).onShrink&&i(a).onShrink()}}function A(){function r(e,n,i){var o=function(t){return u(t).childNodes[0]}(e),r=x(n),l=E(i);o.style.setProperty("width",r+"px",t.important?"important":""),o.style.setProperty("height",l+"px",t.important?"important":"")}function l(l){var c=a.offsetWidth,d=a.offsetHeight,u=c!==i(a).lastWidth||d!==i(a).lastHeight;p("Storing current size",c,d),b(a,c,d),n.add(0,(function(){if(u)if(i(a))if(s()){if(t.debug){var n=a.offsetWidth,l=a.offsetHeight;n===c&&l===d||e.warn(o.get(a),"Scroll: Size changed before updating detector elements.")}r(a,c,d)}else p("Aborting because element container has not been initialized");else p("Aborting because element has been uninstalled")})),n.add(1,(function(){i(a)?s()?S(a,c,d):p("Aborting because element container has not been initialized"):p("Aborting because element has been uninstalled")})),u&&l&&n.add(2,(function(){i(a)?s()?l():p("Aborting because element container has not been initialized"):p("Aborting because element has been uninstalled")}))}function s(){return!!i(a).container}function c(){p("notifyListenersIfNeeded invoked");var t=i(a);return void 0===i(a).lastNotifiedWidth&&t.lastWidth===t.startSize.width&&t.lastHeight===t.startSize.height?p("Not notifying: Size is the same as the start size, and there has been no notification yet."):t.lastWidth===t.lastNotifiedWidth&&t.lastHeight===t.lastNotifiedHeight?p("Not notifying: Size already notified"):(p("Current size not notified, notifying..."),t.lastNotifiedWidth=t.lastWidth,t.lastNotifiedHeight=t.lastHeight,void f(i(a).listeners,(function(t){t(a)})))}function d(){p("Scroll detected."),m(a)?p("Scroll event fired while unrendered. Ignoring..."):l(c)}if(p("registerListenersAndPositionElements invoked."),i(a)){i(a).onRendered=function(){if(p("startanimation triggered."),m(a))p("Ignoring since element is still unrendered...");else{p("Element rendered.");var t=u(a),e=h(a);0!==t.scrollLeft&&0!==t.scrollTop&&0!==e.scrollLeft&&0!==e.scrollTop||(p("Scrollbars out of sync. Updating detector elements..."),l(c))}},i(a).onExpand=d,i(a).onShrink=d;var g=i(a).style;r(a,g.width,g.height)}else p("Aborting because element has been uninstalled")}function L(){if(p("finalizeDomMutation invoked."),i(a)){var t=i(a).style;b(a,t.width,t.height),S(a,t.width,t.height)}else p("Aborting because element has been uninstalled")}function z(){d(a)}function D(){p("Installing..."),i(a).listeners=[],function(){var t=g();i(a).startSize={width:t.width,height:t.height},p("Element start size",i(a).startSize)}(),n.add(0,v),n.add(1,k),n.add(2,A),n.add(3,L),n.add(4,z)}d||(d=a,a=t,t=null),t=t||{},p("Making detectable..."),!function(t){return!function(t){var e=t.getRootNode&&t.getRootNode().contains(t);return t===t.ownerDocument.body||t.ownerDocument.body.contains(t)||e}(t)||null===window.getComputedStyle(t)}(a)?D():(p("Element is detached"),T(),p("Waiting until element is attached..."),i(a).onRendered=function(){p("Element is now attached"),D()})},addListener:function(t,e){if(!i(t).listeners.push)throw new Error("Cannot add listener to an element that is not detectable.");i(t).listeners.push(e)},uninstall:function(t){var e=i(t);e&&(e.onExpandScroll&&d(u(t),"scroll",e.onExpandScroll),e.onShrinkScroll&&d(h(t),"scroll",e.onShrinkScroll),e.onAnimationStart&&d(e.container,"animationstart",e.onAnimationStart),e.container&&t.removeChild(e.container))},initDocument:a}},p=r.forEach;function m(t){return Array.isArray(t)||void 0!==t.length}function g(t){if(Array.isArray(t))return t;var e=[];return p(t,(function(t){e.push(t)})),e}function v(t){return t&&1===t.nodeType}var b=function(t){var e,n;if((t=t||{}).idHandler)e={get:function(e){return t.idHandler.get(e,!0)},set:t.idHandler.set};else{var i=function(t){var e=t.idGenerator,n=t.stateHandler.getState;return{get:function(t){var e=n(t);return e&&void 0!==e.id?e.id:null},set:function(t){var i=n(t);if(!i)throw new Error("setId required the element to have a resize detection state.");var o=e.generate();return i.id=o,o}}}({idGenerator:(n=1,{generate:function(){return n++}}),stateHandler:u});e=i}var o=t.reporter;o||(o=function(t){function e(){}var n={log:e,warn:e,error:e};if(!t&&window.console){var i=function(t,e){t[e]=function(){var t=console[e];if(t.apply)t.apply(console,arguments);else for(var n=0;n<arguments.length;n++)t(arguments[n])}};i(n,"log"),i(n,"warn"),i(n,"error")}return n}(!1===o));var r=y(t,"batchProcessor",s({reporter:o})),a={};a.callOnAdd=!!y(t,"callOnAdd",!0),a.debug=!!y(t,"debug",!1);var c,d=function(t){var e={};function n(n){var i=t.get(n);return void 0===i?[]:e[i]||[]}return{get:n,add:function(n,i){var o=t.get(n);e[o]||(e[o]=[]),e[o].push(i)},removeListener:function(t,e){for(var i=n(t),o=0,r=i.length;o<r;++o)if(i[o]===e){i.splice(o,1);break}},removeAllListeners:function(t){var e=n(t);e&&(e.length=0)}}}(e),f=function(t){var e=t.stateHandler.getState;return{isDetectable:function(t){var n=e(t);return n&&!!n.isDetectable},markAsDetectable:function(t){e(t).isDetectable=!0},isBusy:function(t){return!!e(t).busy},markBusy:function(t,n){e(t).busy=!!n}}}({stateHandler:u}),b=y(t,"strategy","object"),w=y(t,"important",!1),x={reporter:o,batchProcessor:r,stateHandler:u,idHandler:e,important:w};if("scroll"===b&&(l.isLegacyOpera()?(o.warn("Scroll strategy is not supported on legacy Opera. Changing to object strategy."),b="object"):l.isIE(9)&&(o.warn("Scroll strategy is not supported on IE9. Changing to object strategy."),b="object")),"scroll"===b)c=h(x);else{if("object"!==b)throw new Error("Invalid strategy name: "+b);c=function(t){var e=(t=t||{}).reporter,n=t.batchProcessor,i=t.stateHandler.getState;if(!e)throw new Error("Missing required dependency: reporter.");function o(e){var n=t.important?" !important; ":"; ";return(e.join(n)+n).trim()}function r(t){return i(t).object}return{makeDetectable:function(t,r,a){a||(a=r,r=t,t=null),(t=t||{}).debug,l.isIE(8)?a(r):function(r,a){var s=o(["display: block","position: absolute","top: 0","left: 0","width: 100%","height: 100%","border: none","padding: 0","margin: 0","opacity: 0","z-index: -1000","pointer-events: none"]),c=!1,d=window.getComputedStyle(r),u=r.offsetWidth,f=r.offsetHeight;function h(){function n(){if("static"===d.position){r.style.setProperty("position","relative",t.important?"important":"");var n=function(e,n,i,o){var r=i[o];"auto"!==r&&"0"!==function(t){return t.replace(/[^-\d\.]/g,"")}(r)&&(e.warn("An element that is positioned static has style."+o+"="+r+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+o+" will be set to 0. Element: ",n),n.style.setProperty(o,"0",t.important?"important":""))};n(e,r,d,"top"),n(e,r,d,"right"),n(e,r,d,"bottom"),n(e,r,d,"left")}}""!==d.position&&(n(),c=!0);var o=document.createElement("object");o.style.cssText=s,o.tabIndex=-1,o.type="text/html",o.setAttribute("aria-hidden","true"),o.onload=function(){c||n(),function t(e,n){if(!e.contentDocument){var o=i(e);return o.checkForObjectDocumentTimeoutId&&window.clearTimeout(o.checkForObjectDocumentTimeoutId),void(o.checkForObjectDocumentTimeoutId=setTimeout((function(){o.checkForObjectDocumentTimeoutId=0,t(e,n)}),100))}n(e.contentDocument)}(this,(function(t){a(r)}))},l.isIE()||(o.data="about:blank"),i(r)&&(r.appendChild(o),i(r).object=o,l.isIE()&&(o.data="about:blank"))}i(r).startSize={width:u,height:f},n?n.add(h):h()}(r,a)},addListener:function(t,e){function n(){e(t)}if(l.isIE(8))i(t).object={proxy:n},t.attachEvent("onresize",n);else{var o=r(t);if(!o)throw new Error("Element is not detectable by this strategy.");o.contentDocument.defaultView.addEventListener("resize",n)}},uninstall:function(t){if(i(t)){var e=r(t);e&&(l.isIE(8)?t.detachEvent("onresize",e.proxy):t.removeChild(e),i(t).checkForObjectDocumentTimeoutId&&window.clearTimeout(i(t).checkForObjectDocumentTimeoutId),delete i(t).object)}}}}(x)}var E={};return{listenTo:function(t,n,i){function r(t){var e=d.get(t);p(e,(function(e){e(t)}))}function l(t,e,n){d.add(e,n),t&&n(e)}if(i||(i=n,n=t,t={}),!n)throw new Error("At least one element required.");if(!i)throw new Error("Listener required.");if(v(n))n=[n];else{if(!m(n))return o.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");n=g(n)}var s=0,h=y(t,"callOnAdd",a.callOnAdd),b=y(t,"onReady",(function(){})),x=y(t,"debug",a.debug);p(n,(function(t){u.getState(t)||(u.initState(t),e.set(t));var a=e.get(t);if(x&&o.log("Attaching listener to element",a,t),!f.isDetectable(t))return x&&o.log(a,"Not detectable."),f.isBusy(t)?(x&&o.log(a,"System busy making it detectable"),l(h,t,i),E[a]=E[a]||[],void E[a].push((function(){++s===n.length&&b()}))):(x&&o.log(a,"Making detectable..."),f.markBusy(t,!0),c.makeDetectable({debug:x,important:w},t,(function(t){if(x&&o.log(a,"onElementDetectable"),u.getState(t)){f.markAsDetectable(t),f.markBusy(t,!1),c.addListener(t,r),l(h,t,i);var e=u.getState(t);if(e&&e.startSize){var d=t.offsetWidth,m=t.offsetHeight;e.startSize.width===d&&e.startSize.height===m||r(t)}E[a]&&p(E[a],(function(t){t()}))}else x&&o.log(a,"Element uninstalled before being detectable.");delete E[a],++s===n.length&&b()})));x&&o.log(a,"Already detecable, adding listener."),l(h,t,i),s++})),s===n.length&&b()},removeListener:d.removeListener,removeAllListeners:d.removeAllListeners,uninstall:function(t){if(!t)return o.error("At least one element is required.");if(v(t))t=[t];else{if(!m(t))return o.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");t=g(t)}p(t,(function(t){d.removeAllListeners(t),c.uninstall(t),u.cleanState(t)}))},initDocument:function(t){c.initDocument&&c.initDocument(t)}}};function y(t,e,n){var i=t[e];return null==i&&void 0!==n?n:i}var w={name:"m-scroller",props:{scrollLeft:{type:Number,default:0},scrollTop:{type:Number,default:0},step:{type:Number,default:0}},data:function(){return{$content:null,width:0,scrollWidth:0,height:0,scrollHeight:0,scrollleft:this.scrollLeft,scrolltop:this.scrollTop,show:!1,timer:null,t1:{top:0,left:0},t2:{top:0,left:0}}},methods:{init:function(){var t=this.$content;this.width=t.parentNode.offsetWidth,this.height=t.parentNode.offsetHeight,this.scrollWidth=t.scrollWidth,this.scrollHeight=t.scrollHeight},renderBarX:function(){var t=this.$createElement,e=this.width,i=this.scrollWidth;if(e&&!(i-e<=1)){var o={},r=e*(e/i),l=e-r,a=i-e,s=this.scrollleft/a;return o.width="".concat(r,"px"),o.transform="translateX(".concat(l*s,"px)"),t("div",{style:o,class:n,attrs:{type:"x"}})}},renderBarY:function(){var t=this.$createElement,e=this.height,i=this.scrollHeight;if(e&&!(e>=i)){var o={},r=e*(e/i),l=e-r,a=i-e,s=this.scrolltop/a;return o.height="".concat(r,"px"),o.transform="translateY(".concat(l*s,"px)"),t("div",{style:o,class:n,attrs:{type:"y"}})}},onScroll:function(){var t=this;this.scrollleft=this.$content.scrollLeft,this.scrolltop=this.$content.scrollTop,clearTimeout(this.timer),this.t1={top:this.$content.scrollTop,left:this.$content.scrollLeft},this.timer=setTimeout((function(){if(t.t2={left:t.$content.scrollLeft,top:t.$content.scrollTop},t.t1.left===t.t2.left&&t.t1.top===t.t2.top)if(t.step){var e=Math.round(t.t2.top/t.step),n=Math.round(t.t2.left/t.step);t.$content.scrollTop=e*t.step,t.$content.scrollLeft=n*t.step,t.$emit("scrollEnd",{top:e*t.step,left:n*t.step})}else t.$emit("scrollEnd",t.t2)}),100),this.$emit("update:scrollLeft",this.scrollleft),this.$emit("update:scrollTop",this.scrolltop),this.$emit("scroll",{left:this.scrollleft,top:this.scrolltop})},onClick:function(t){this.$emit("click",t)}},computed:{scrollBarWidth:function(){return i()},contentStyle:function(){var t=this.scrollBarWidth;return{marginRight:"".concat(-t,"px"),marginBottom:"".concat(-t,"px")}}},mounted:function(){var t=this;this.$content=this.$refs.content,b({strategy:"object",callOnAdd:!0}).listenTo(this.$refs.content.childNodes[0],(function(e){t.scrollBarWidth&&(t.init(),t.scrollTop&&(t.$content.scrollTop=t.scrollTop),t.scrollLeft&&(t.$content.scrollLeft=t.scrollLeft))}))},render:function(n){return n("div",{class:t,attrs:{visible:this.show}},[n("div",{class:e,style:this.contentStyle,ref:"content",on:{scroll:this.onScroll}},[n("div",[this.$slots.default])]),this.renderBarY(),this.renderBarX()])},install:function(t){t.components(w.name,w)}};return w}));
